{% extends "base.html" %}
{% block title%}
Lista de Productos
{% endblock %}
{% block content %}
<div class="content">
  <a href="{% url 'home' %}"></a>
  <h1>Lista de Productos</h1>
  <h3>Opciones de filtrado</h3>
  <form method="post" action="{% url 'listar_productos' %}">
    {% csrf_token %}
    <select name="categoria_id" id="categoria">
      <option value="">Categorias</option>
      {% for categoria in categorias %}
      <option value="{{ categoria.id }}" {% if categoria.id == categoria_id %}selected{% endif %}>
        {{categoria.nombre}}
      </option>
      {% endfor %}
    </select>

    <label for="precio_min">Precio desde: </label>
    <input type="number" name="precio_min" id="precio_min" {%if not mostrar_todos %}value="{{ precio_min }}"{% endif %}>
    <label for="precio_min"> Hasta: </label>
    <input type="number" name="precio_max" id="precio_max" {%if not mostrar_todos %}value="{{ precio_max }}"{% endif %}">
    <label for="mostrar_todos">Mostrar Todos</label>
    <input type="checkbox" name="mostrar_todos" id="mostrar_todos" {% if mostrar_todos %}checked{% endif %}>
    <button type="submit">Filtrar</button>
  </form>
  <h4>Tabla de productos</h4>
  <table>
    <thead>
      <tr>
        <th># Producto</th>
        <th>Categoria</th>
        <th>Nombre</th>
        <th>Stock</th>
        <th>Stock Estado</th>
        <th>Precio de Compra</th>
        <th>Precio de Venta</th>
        <th>Acci√≥n</th>
      </tr>
    </thead>
    <tbody>
      {% for producto in productos %}
      <tr>
        <td>{{ producto.id }}</td>
        <td>
          <ul>
            {% for categoria in producto.categorias.all %}
            <li>{{categoria}}</li>
            {% endfor%}
          </ul>
        </td>
        <td>{{ producto.nombre }}</td>
        <td>{{ producto.stock }}</td>
        <td>Estado de stock</td>
        <td>{{ producto.precio_compra }}</td>
        <td>{{ producto.precio_venta}}</td>
        <td>
          <ul>
            <li>
              <a href="{% url 'modificar_producto' producto.id %}">Modificar Producto</a>
            </li>
            <li>
              <a href="{% url 'eliminar_producto' producto.id %}">Eliminar Producto</a>
            </li>
          </ul>
          <!--
                    <form action="" method="post">
                        {% csrf_token %}
                        <button type="submit" class="delete-button">Eliminar</button>
                    </form>
                  -->
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <!--
<div class="actions">
  <a href="" class="btn export-btn">Crear Excel</a>
  <a href="" class="btn add-btn">Agregar Venta</a>
</div>
-->
  <a href="{% url 'crear_producto' %}">Crear Producto</a>
</div>
{% endblock %}